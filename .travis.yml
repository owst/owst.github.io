lang: ruby
sudo: false
env:
  - BRANCH=travis_test_builds
cache: bundler
script:
  - bundle exec jekyll build
after_success:
  - git checkout -b $BRANCH
  - mv CNAME .git _site/
  - find . -mindepth 1 -maxdepth 1 -not -name _site -exec rm -r {} \;
  - mv _site/* _site/.git .
  - rmdir _site
  - git add .
  - git config --global user.email "travis@travis-ci.org"
  - git config --global user.name "Travis CI"
  - git commit --all --message "Travis build: $TRAVIS_BUILD_NUMBER"
  - git remote add github
  - git push https://${GH_TOKEN}@github.com/owst/owst.github.io $BRANCH
